(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/qing-f-c/followRecord/publicDialog"],{"32f9":function(e,t,n){"use strict";(function(e){n("3b9b"),n("921b");a(n("66fd"));var t=a(n("9565"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},"64d4":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("4795"));function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,i,o,r){try{var u=e[o](r),c=u.value}catch(l){return void n(l)}u.done?t(c):Promise.resolve(c).then(a,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function u(e){r(o,a,i,u,c,"next",e)}function c(e){r(o,a,i,u,c,"throw",e)}u(void 0)}))}}var c,l,s=function(){n.e("components/uni-load-more/uni-load-more").then(function(){return resolve(n("fbad"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components/uni-icons/uni-icons").then(function(){return resolve(n("2cee"))}.bind(null,n)).catch(n.oe)},g={components:{uniIcon:d,uniLoadMore:s},data:function(){return{loadingType:"more",list:[],content:"",postCode:"",buyOrSell:"",messageType:0,fileUrl:"",pageNum:1,pageSize:5,pictures:[],totalCount:0}},filters:{strToArr:function(e){return e.split(",")}},onReachBottom:function(){this.fetchList()},onPullDownRefresh:function(){e("log","here here"," at pages/qing-f-c/followRecord/publicDialog.vue:81"),null!=l&&clearTimeout(l),l=setTimeout((function(){c.fetchMoreList()}),1e3)},onLoad:function(e){c=this,this.buyOrSell=e.buyOrSell,this.recordCode=e.recordCode,this.postCode=a.getStorageSync("pupDefault"),this.fetchList()},methods:{fetchList:function(){var t=this;return u(i.default.mark((function n(){var o,r,u;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.pageSize=5,o={recordCode:t.recordCode,buyOrSell:t.buyOrSell,pageNum:t.pageNum,pageSize:t.pageSize},n.next=4,t.$http.get("/latent/dialog_list",{data:o});case 4:if(r=n.sent,e("log",r," at pages/qing-f-c/followRecord/publicDialog.vue:111"),!(r.data.data.totalCount>t.totalCount)){n.next=13;break}t.totalCount=r.data.data.totalCount,t.list=r.data.data.list.reverse(),t.list.forEach((function(e){1==e.messageType&&(e.contentList[0].content=e.contentList[0].content.split(","))})),t.list.length>0&&(u="#msg-".concat(t.list[t.list.length-1].messageCode),e("log",u," at pages/qing-f-c/followRecord/publicDialog.vue:123"),t.$nextTick((function(){a.createSelectorQuery().select(u).boundingClientRect((function(t){e("log",t," at pages/qing-f-c/followRecord/publicDialog.vue:126"),a.pageScrollTo({duration:300,scrollTop:t.bottom-150})})).exec()}))),n.next=14;break;case 13:return n.abrupt("return");case 14:case"end":return n.stop()}}),n)})))()},fetchMoreList:function(){var e=this;return u(i.default.mark((function t(){var n,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageSize+=5,c.loadingType="loading",a.showNavigationBarLoading(),n={recordCode:e.recordCode,buyOrSell:e.buyOrSell,pageNum:e.pageNum,pageSize:e.pageSize},t.next=6,e.$http.get("/latent/dialog_list",{data:n});case 6:if(o=t.sent,a.hideNavigationBarLoading(),!(o.data.data.list.length<e.pageSize)){t.next=11;break}return c.loadingType="",t.abrupt("return");case 11:e.list=o.data.data.list.reverse(),e.list.forEach((function(e){1==e.messageType&&(e.contentList[0].content=e.contentList[0].content.split(","))})),c.loadingType="more",a.stopPullDownRefresh();case 15:case"end":return t.stop()}}),t)})))()},sendText:function(){this.messageType=0,this.pictures="",this.sendMessage()},sendMessage:function(){var e=this;return u(i.default.mark((function t(){var n;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={postCode:e.postCode,recordCode:e.recordCode,buyOrSell:e.buyOrSell,messageType:e.messageType,content:e.content,fileUrl:e.pictures},a.showLoading({title:"发言中",mask:!0}),t.next=4,e.$http.post("/latent/dialog_add",{data:n});case 4:t.sent,a.hideLoading(),e.content="",e.pictures="",e.fetchList();case 9:case"end":return t.stop()}}),t)})))()},pickImage:function(){a.chooseImage({sizeType:["compressed"],success:function(t){for(var n=t.tempFilePaths,i=[],o=0;o<n.length;o++)a.uploadFile({url:c.Api.upload,filePath:n[o],name:"file",success:function(t){e("log",t," at pages/qing-f-c/followRecord/publicDialog.vue:212"),i.push(JSON.parse(t.data).data.msg),c.pictures=i.join(","),c.pictures.split(",").length==n.length&&(c.messageType=1,c.sendMessage())}})},complete:function(){a.showToast({title:"上传成功",icon:"none",duration:1e3})}})},selectDeputy:function(e){var t=e.detail.value;"@"==t.substr(t.length-1,1)&&(a.hideKeyboard(),a.navigateTo({url:"./selectContact?buyOrSell=".concat(this.buyOrSell)}))},toBigPic:function(e){a.previewImage({urls:[e]})},toInquiryDetail:function(e,t){if(t>0){var n=a.getStorageSync("pupDefault");switch(n){case"SELL_DEPUTY":1==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sellDeputy/inquiry-details?inquiryNumber=".concat(e)}):2==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sellDeputy/inquiry-details?inquiryNumber=".concat(e)}):3==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sellDeputy/inquiry-details?inquiryNumber=".concat(e)}):4==t&&a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sellDeputy/inquiry-details?inquiryNumber=".concat(e)});break;case"BUY_DEPUTY":1==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/inquiry-details?inquiryNumber=".concat(e)}):2==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/buyDeputy/inquiry-details?inquiryNumber=".concat(e)}):3==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/quotedPrice/quotedPrice?quoteNumber=".concat(e)}):4==t&&a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/buyDeputy/quotationDetails/quotationDetails?number=".concat(e)});break;case"SALES_DIRECTOR":1==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sales_director/inquiry-details?inquiryNumber=".concat(e)}):2==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sales_director/inquiry-details?inquiryNumber=".concat(e)}):3==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sales_director/quotation-detail?quoteNumber=".concat(e)}):4==t&&a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sales_director/quotation-details?number=".concat(e)});break;case"REGIONAL_MANAGER":break;case"ANALYST":break}}}}};t.default=g}).call(this,n("0de9")["default"],n("6e42")["default"])},"66ee":function(e,t,n){"use strict";var a,i=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}))},"7f5b":function(e,t,n){"use strict";n.r(t);var a=n("64d4"),i=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},9565:function(e,t,n){"use strict";n.r(t);var a=n("66ee"),i=n("7f5b");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("9b11");var r,u=n("f0c5"),c=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);t["default"]=c.exports},"9b11":function(e,t,n){"use strict";var a=n("d72e"),i=n.n(a);i.a},d72e:function(e,t,n){}},[["32f9","common/runtime","common/vendor"]]]);