(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/qing-f-c/buyDupty/customer-admin"],{"0dc5":function(e,t,n){"use strict";var o,i=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},"7d95":function(e,t,n){"use strict";(function(e){n("3b9b"),n("921b");o(n("66fd"));var t=o(n("ab70"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},a56f:function(e,t,n){"use strict";var o=n("fa70"),i=n.n(o);i.a},ab70:function(e,t,n){"use strict";n.r(t);var o=n("0dc5"),i=n("cdfa");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("a56f");var u,s=n("f0c5"),r=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);t["default"]=r.exports},b411:function(e,t,n){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,a=u(n("4795"));function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t,n,o,i,a,u){try{var s=e[a](u),r=s.value}catch(c){return void n(c)}s.done?t(r):Promise.resolve(r).then(o,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function u(e){r(a,o,i,u,s,"next",e)}function s(e){r(a,o,i,u,s,"throw",e)}u(void 0)}))}}var l,d,g=function(){n.e("components/dropMenuRegion").then(function(){return resolve(n("a9a8"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/dropMenuDeputy").then(function(){return resolve(n("6252"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components/dropMenuLevel").then(function(){return resolve(n("951a"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/dropMenuPrivateLevel").then(function(){return resolve(n("02674"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components/uni-icons/uni-icons").then(function(){return resolve(n("2cee"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/uni-load-more/uni-load-more").then(function(){return resolve(n("fbad"))}.bind(null,n)).catch(n.oe)},y=function(){n.e("components/ms-dropdown/dropdown-menu").then(function(){return resolve(n("d8d8"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("components/ms-dropdown/dropdown-item").then(function(){return resolve(n("fa40"))}.bind(null,n)).catch(n.oe)},L=20,C=(n("b65b"),i={components:{uniIcon:m,uniLoadMore:v,msDropdownMenu:y,msDropdownItem:b,dropMenuRegion:g,dropMenuDeputy:p,dropMenuLevel:f,dropMenuPirLevel:h},data:function(){return{regionList:[],tabTwo:0,compileing:!1,allPitchOn:!1,inputValueOne:"",setOver:!1,selectContent:[],bindSelect:!1,loadingType:"more",loading:!1,numOne:0,numTwo:0,numThree:0,customerList:[],isFilterBuyer:!1,isFilterSeller:!1,pageNum:1,buyOrSell:-1,isAllocation:-1,isLastPage:!1,codeValue:[],isDoRefresh:!1,totalPage:"",userCode:"",privateLevel:"",companyLevel:"",regionCode:"",postCode:"",totalCount:""}},onReachBottom:function(){null!=d&&clearTimeout(d),d=setTimeout((function(){l.getMoreCustomer()}),1e3)},onPullDownRefresh:function(){l.getCustomerList()},onShow:function(){var t=getCurrentPages(),n=t[t.length-1];e("log",n," at pages/qing-f-c/buyDupty/customer-admin.vue:175"),this.getCustomerList()},onLoad:function(e){l=this,this.postCode=o.getStorageSync("pupDefault"),this.regionCode=this.$store.state.regionCode,this.checkLogin()&&this.getCustomerList()},onNavigationBarButtonTap:function(e){this.tabTwo>0&&this.tapCompile()}},s(i,"components",{}),s(i,"props",{}),s(i,"methods",{goCustomerCreated:function(){wx.navigateTo({url:"/pages/qing-f-c/buyDupty/customer-created"})},getRegionCode:function(){var t=this;return c(a.default.mark((function n(){var o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("/cm/region_deputy");case 2:o=n.sent,t.regionList=o.data.data.list,t.tapRegion(t.regionCode),e("log",o," at pages/qing-f-c/buyDupty/customer-admin.vue:219");case 6:case"end":return n.stop()}}),n)})))()},tapRegion:function(t){var n=this;e("log",t," at pages/qing-f-c/buyDupty/customer-admin.vue:222"),this.regionList.forEach((function(e,o){e.regionCode==t&&(n.$refs.refDeputy.selectContent=n.regionList[o].list,n.regionList[o].list.length>6?n.$refs.refDeputy.index=2:n.$refs.refDeputy.index=1)}))},tapSelectLevel:function(t){e("log",t," at pages/qing-f-c/buyDupty/customer-admin.vue:238"),this.companyLevel=t,this.pageNum=1,this.loadingType="more",this.privateLevel="",this.getCustomerList()},tapSelectPrivateLevel:function(t){e("log",t," at pages/qing-f-c/buyDupty/customer-admin.vue:246"),this.privateLevel=t,this.companyLevel="",this.pageNum=1,this.loadingType="more",this.getCustomerList()},tapSelectDeputy:function(t){e("log",t," at pages/qing-f-c/buyDupty/customer-admin.vue:254"),this.userCode=t,this.pageNum=1,this.loadingType="more",this.getCustomerList()},getMoreCustomer:function(){var t=this;return c(a.default.mark((function n(){var i,u;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("more"===l.loadingType){n.next=2;break}return n.abrupt("return",!1);case 2:return l.loadingType="loading",o.showNavigationBarLoading(),i={keyword:l.inputValueOne,regionCode:l.regionCode,isAllocation:l.isAllocation,pageNum:l.pageNum,pageSize:L,postCode:t.postCode,userCode:t.userCode,companyLevel:t.companyLevel,privateLevel:t.privateLevel},n.next=7,t.$http.get("/cm/list",{data:i});case 7:if(u=n.sent,0!=u.data.data.list.length){n.next=13;break}return e("log","no data"," at pages/qing-f-c/buyDupty/customer-admin.vue:284"),l.loadingType="",o.hideNavigationBarLoading(),n.abrupt("return");case 13:l.pageNum++,e("log",u," at pages/qing-f-c/buyDupty/customer-admin.vue:290"),l.customerList=l.customerList.concat(u.data.data.list),l.loadingType="more",o.hideNavigationBarLoading();case 18:case"end":return n.stop()}}),n)})))()},getCustomerList:function(){var t=this;return c(a.default.mark((function n(){var i,u;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return l.pageNum=1,l.loadingType="more",o.showNavigationBarLoading(),i={keyword:l.inputValueOne,regionCode:l.regionCode,isAllocation:l.isAllocation,pageNum:l.pageNum,pageSize:L,postCode:t.postCode,userCode:t.userCode,companyLevel:t.companyLevel,privateLevel:t.privateLevel},e("log","客户请求参数",i," at pages/qing-f-c/buyDupty/customer-admin.vue:314"),n.next=7,t.$http.get("/cm/list",{data:i});case 7:u=n.sent,e("log","客户信息===",u," at pages/qing-f-c/buyDupty/customer-admin.vue:317"),l.pageNum++,l.customerList=u.data.data.list,t.totalCount=u.data.data.totalCount,l.isLastPage=u.data.data.isLastPage,l.totalPage=u.data.data.totalPage,l.loadingType="more",o.hideNavigationBarLoading();case 16:case"end":return n.stop()}}),n)})))()},checkboxChange:function(e){this.codeValue=e.detail.value},tabAllPitchOn:function(){this.allPitchOn=!this.allPitchOn,e("log","quanxuankuang",this.allPitchOn," at pages/qing-f-c/buyDupty/customer-admin.vue:352");var t=[];this.allPitchOn?(this.customerList.forEach((function(e){t.push(e.companyCode)})),l.codeValue=t):l.codeValue=[]},blurInput:function(t){e("log",this.inputValueOne,t.detail.value," at pages/qing-f-c/buyDupty/customer-admin.vue:366")},tapBuyFilter:function(e){var t;this.buyOrSell=1,this.isFilterBuyer=!0,this.isFilterSeller=!1,t=0==this.selectContent[0].id?"":this.selectContent[0].id,this.getCustomerList(this.pageNum,this.isAllocation,this.buyOrSell,t)},tapSellFilter:function(){var e;this.buyOrSell=2,this.isFilterBuyer=!1,this.isFilterSeller=!0,e=0==this.selectContent[0].id?"":this.selectContent[0].id,this.getCustomerList(this.pageNum,this.isAllocation,this.buyOrSell,e)},bindSearch:function(e){},bindSelectFunc:function(){this.bindSelect=!this.bindSelect},tapSearch:function(){o.showLoading({title:"搜索中..."}),this.pageNum=1,this.isAllocation=-1,this.buyOrSell=-1,this.getCustomerList(),setTimeout((function(){o.hideLoading()}),1e3)},setNavButton:function(e){var t=getCurrentPages(),n=t[t.length-1],o=n.$getAppWebview(),i=o.getStyle().titleNView;i.buttons[0].text=e,o.setStyle({titleNView:i})},tapTabTwo:function(t){var n=t.currentTarget.dataset.index;this.tabTwo=n,e("log",n," at pages/qing-f-c/buyDupty/customer-admin.vue:453"),0==n&&(this.setNavButton(""),this.isAllocation=-1,this.compileing=!1),1==n&&(this.setNavButton("编辑"),this.isAllocation=1,this.pageNum=1),2==n&&(this.setNavButton("编辑"),this.isAllocation=0,this.pageNum=1,e("log","分配状态：",this.isAllocation," at pages/qing-f-c/buyDupty/customer-admin.vue:474")),this.getCustomerList()},tapCompile:function(){this.compileing=!this.compileing,this.compileing?this.setNavButton("完成"):this.setNavButton("编辑")},setTime:function(){var e=new Date,t=e.getMonth()+1;t=t<10?"0"+t:t;var n=e.getFullYear()+"-"+t+"-"+e.getDate();this.newTime=n},toSingleAllo:function(e){l.codeValue=[],l.codeValue.push(e),this.toAllotAreaManager()},delSingleAllo:function(e){l.codeValue=[],l.codeValue.push(e),this.deleteAllot()},toAllotAreaManager:function(){var t=this,n=l.codeValue,i=[];if(l.codeValue.forEach((function(e){t.customerList.forEach((function(t){t.companyCode==e&&i.push(t.buyOrSell)}))})),i.includes(1)&&i.includes(2))o.showToast({title:"不能同时选择买家和卖家",icon:"none"});else{e("log","optionList===",n.length," at pages/qing-f-c/buyDupty/customer-admin.vue:539"),n.length>0?(n=JSON.stringify(n),o.navigateTo({url:"/pages/qing-f-c/regionalManager/deputy-list?optionList="+n+"&buyOrSell="+i[0]})):o.showToast({title:"至少选择一个客户",icon:"none"})}},deleteAllot:function(){var t=this;o.showModal({title:"移除分配",content:"确认要移除该分配吗？不要请返回",showCancel:!0,cancelText:"返回",confirmText:"我要移除",success:function(n){if(n.confirm){var o=l.codeValue,i={companyCodes:o},a=t.Api.managerDel;t.myRequest(i,a,"post").then((function(n){e("log","区域经理删除分配",n," at pages/qing-f-c/buyDupty/customer-admin.vue:569"),0==n.data.status&&(wx.showToast({title:"成功删除分配"}),t.getCustomerList(t.pageNum,t.isAllocation))})).catch((function(t){e("log","getBSList=err==",n," at pages/qing-f-c/buyDupty/customer-admin.vue:579")}))}else if(n.cancel)return},fail:function(){},complete:function(){}})},toClientDetail:function(t){e("log",t," at pages/qing-f-c/buyDupty/customer-admin.vue:598"),wx.navigateTo({url:"./customer-details?companyCode="+t})}}),i);t.default=C}).call(this,n("0de9")["default"],n("6e42")["default"])},cdfa:function(e,t,n){"use strict";n.r(t);var o=n("b411"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},fa70:function(e,t,n){}},[["7d95","common/runtime","common/vendor"]]]);