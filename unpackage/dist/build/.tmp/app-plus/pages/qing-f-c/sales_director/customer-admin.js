(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/qing-f-c/sales_director/customer-admin"],{"1d1b":function(t,e,i){"use strict";var n,o=function(){var t=this,e=t.$createElement;t._self._c},a=[];i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}))},"1f2a":function(t,e,i){},"52d4":function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,a,s,l=function(){i.e("components/uni-icons/uni-icons").then(function(){return resolve(i("2cee"))}.bind(null,i)).catch(i.oe)},u=function(){i.e("components/uni-load-more/uni-load-more").then(function(){return resolve(i("fbad"))}.bind(null,i)).catch(i.oe)},c=20,r=i("b65b"),d={components:{uniIcon:l,uniLoadMore:u},data:function(){return{loadingType:"more",tabTwo:0,compileing:!1,allPitchOn:!1,inputValueOne:"",setOver:!1,selectContent:[],bindSelect:!1,loading:!1,numOne:0,numTwo:0,numThree:0,customerList:[],isFilterBuyer:!1,isFilterSeller:!1,pageNum:1,buyOrSell:-1,isAllocation:-1,isLastPage:!1,codeValue:[],isDoRefresh:!1,totalPage:"",regionCode:""}},onReachBottom:function(){null!=s&&clearTimeout(s),s=setTimeout((function(){o.getMoreCustomer()}),1e3)},onPullDownRefresh:function(){o.getCustomerList()},onShow:function(){var t=getCurrentPages(),e=t[t.length-1];1==e.data.isDoRefresh&&(e.data.isDoRefresh=!1,o.pageNum=1,o.getCustomerList()),o.getCustomerList()},onLoad:function(e){o=this,a=t.getStorageSync("pupDefault"),this.checkLogin()&&(o.getCustomerList(this.pageNum,this.isAllocation),o.getRegionCode())},onNavigationBarButtonTap:function(t){this.tabTwo>0&&this.tapCompile()},methods:{getMoreCustomer:function(){if("more"!==o.loadingType)return!1;o.loadingType="loading",t.showNavigationBarLoading();var e={keyword:o.inputValueOne,regionCode:o.regionCode,buyOrSell:o.buyOrSell,isAllocation:o.isAllocation,pageNum:o.pageNum,pageSize:c,postCode:a};r.dmList(e).then((function(e){if(0==e.data.data.list.length)return n("log","no data"," at pages/qing-f-c/sales_director/customer-admin.vue:295"),o.loadingType="",void t.hideNavigationBarLoading();o.pageNum++,n("log",e," at pages/qing-f-c/sales_director/customer-admin.vue:301"),o.customerList=o.customerList.concat(e.data.data.list),o.loadingType="more",t.hideNavigationBarLoading()})).catch((function(t){n("log","getBSList=err==",t," at pages/qing-f-c/sales_director/customer-admin.vue:308")}))},getRegionCode:function(){var t=this.Api.getRegion;this.myRequest({},t,"get").then((function(t){n("log","regionCode",t," at pages/qing-f-c/sales_director/customer-admin.vue:315"),o.selectContent=t.data.data.list,o.selectContent.unshift({id:0,label:"全部区域"}),n("log","regionCode===",o.selectContent," at pages/qing-f-c/sales_director/customer-admin.vue:318")})).catch((function(t){n("log","getBSList=err==",res," at pages/qing-f-c/sales_director/customer-admin.vue:321")}))},getCustomerList:function(){o.pageNum=1,o.loadingType="more",t.showNavigationBarLoading();var e={keyword:o.inputValueOne,regionCode:o.regionCode,buyOrSell:o.buyOrSell,isAllocation:o.isAllocation,pageNum:o.pageNum,pageSize:c,postCode:a};n("log",e," at pages/qing-f-c/sales_director/customer-admin.vue:340"),r.dmList(e).then((function(t){o.pageNum++,o.customerList=t.data.data.list,o.isLastPage=t.data.data.isLastPage,o.totalPage=t.data.data.totalPage})).catch((function(t){n("log","getBSList=err==",res," at pages/qing-f-c/sales_director/customer-admin.vue:350")}));var i={keyword:o.inputValueOne,regionCode:o.regionCode,buyOrSell:o.buyOrSell,postCode:a};r.dmCount(i).then((function(t){n("log","客户数量===",t," at pages/qing-f-c/sales_director/customer-admin.vue:360"),o.numOne=t.data.data.all,o.numTwo=t.data.data.isAllocation,o.numThree=t.data.data.notAllocation})).catch((function(t){n("log","getBSList=err==",res," at pages/qing-f-c/sales_director/customer-admin.vue:365")})),t.hideNavigationBarLoading(),t.stopPullDownRefresh()},checkboxChange:function(t){this.codeValue=t.detail.value},tabAllPitchOn:function(){this.allPitchOn=!this.allPitchOn,n("log","quanxuankuang",this.allPitchOn," at pages/qing-f-c/sales_director/customer-admin.vue:379");var t=[];this.allPitchOn?(this.customerList.forEach((function(e){t.push(e.companyCode)})),o.codeValue=t):o.codeValue=[]},blurInput:function(t){n("log",this.tabOne,t.detail.value," at pages/qing-f-c/sales_director/customer-admin.vue:397")},tapBuyFilter:function(t){this.buyOrSell=1,this.isFilterBuyer=!0,this.isFilterSeller=!1,0==this.selectContent[0].id?o.regionCode="":o.regionCode=this.selectContent[0].id,o.pageNum=1,this.getCustomerList()},tapSellFilter:function(){this.buyOrSell=2,this.isFilterBuyer=!1,this.isFilterSeller=!0,0==this.selectContent[0].id?o.regionCode="":o.regionCode=this.selectContent[0].id,o.pageNum=1,this.getCustomerList()},bindSearch:function(t){},bindSelectFunc:function(){this.bindSelect=!this.bindSelect},bindSelectContent:function(t){var e=t.currentTarget.dataset.index,i=this.selectContent,n=i[0];i[0]=i[e],i[e]=n,0==this.selectContent[0].id?(o.regionCode="",this.getCustomerList()):this.regionCode=this.selectContent[0].id,this.getCustomerList()},tapSearch:function(){t.showLoading({title:"搜索中..."}),o.pageNum=1,this.getCustomerList(),setTimeout((function(){t.hideLoading()}),1e3)},setNavButton:function(t){var e=getCurrentPages(),i=e[e.length-1],n=i.$getAppWebview(),o=n.getStyle().titleNView;o.buttons[0].text=t,n.setStyle({titleNView:o})},tapTabTwo:function(t){var e=t.currentTarget.dataset.index;this.isAllocation=1,this.tabTwo=e,n("log",e," at pages/qing-f-c/sales_director/customer-admin.vue:498"),0==e?(this.setNavButton(""),this.isAllocation=-1,this.compileing=!1):1==e?(this.setNavButton("编辑"),this.isAllocation=1,this.pageNum=1):2==e&&(this.setNavButton("编辑"),this.isAllocation=0,this.pageNum=1,n("log","分配状态：",this.isAllocation," at pages/qing-f-c/sales_director/customer-admin.vue:516")),this.getCustomerList()},tapCompile:function(){this.compileing=!this.compileing,this.compileing?this.setNavButton("完成"):this.setNavButton("编辑")},setTime:function(){var t=new Date,e=t.getMonth()+1;e=e<10?"0"+e:e;var i=t.getFullYear()+"-"+e+"-"+t.getDate();this.newTime=i},toSingleAllo:function(t){o.codeValue=[],o.codeValue.push(t),this.toAllotAreaManager()},delSingleAllo:function(t){o.codeValue=[],o.codeValue.push(t),this.deleteAllot()},toAllotAreaManager:function(){var e=this,i=o.codeValue,a=[];if(o.codeValue.forEach((function(t){e.customerList.forEach((function(e){e.companyCode==t&&a.push(e.buyOrSell)}))})),a.includes(1)&&a.includes(2))t.showToast({title:"不能同时选择买家和卖家",icon:"none"});else{n("log","optionList===",i.length," at pages/qing-f-c/sales_director/customer-admin.vue:579"),i.length>0?(i=JSON.stringify(i),t.navigateTo({url:"/pages/qing-f-c/sales_director/manager-list?optionList="+i+"&buyOrSell="+a[0]})):t.showToast({title:"至少选择一个客户",icon:"none"})}},deleteAllot:function(){var e=this;t.showModal({title:"移除分配",content:"确认要移除该客户分配吗？不要请返回",showCancel:!0,cancelText:"返回",confirmText:"我要移除",success:function(t){if(t.confirm){var i=o.codeValue,a={companyCodes:i},s=e.Api.majordomoDel;e.myRequest(a,s,"post").then((function(t){0==t.data.status&&(wx.showToast({title:"成功删除分配"}),0==e.selectContent[0].id?e.getCustomerList(e.pageNum,e.isAllocation,e.buyOrSell):e.getCustomerList(e.pageNum,e.isAllocation,e.buyOrSell,e.selectContent[0].id))})).catch((function(e){n("log","getBSList=err==",t," at pages/qing-f-c/sales_director/customer-admin.vue:622")}))}else if(t.cancel)return},fail:function(){},complete:function(){}})},toClientDetail:function(t){n("log",t," at pages/qing-f-c/sales_director/customer-admin.vue:641"),wx.navigateTo({url:"/pages/qing-f-c/sales_director/customer-details?companyCode="+t})}}};e.default=d}).call(this,i("6e42")["default"],i("0de9")["default"])},6058:function(t,e,i){"use strict";i.r(e);var n=i("52d4"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},"6d76":function(t,e,i){"use strict";(function(t){i("3b9b"),i("921b");n(i("66fd"));var e=n(i("959b"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])},"6f8c":function(t,e,i){"use strict";var n=i("1f2a"),o=i.n(n);o.a},"959b":function(t,e,i){"use strict";i.r(e);var n=i("1d1b"),o=i("6058");for(var a in o)"default"!==a&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("6f8c");var s,l=i("f0c5"),u=Object(l["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=u.exports}},[["6d76","common/runtime","common/vendor"]]]);