(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/qing-f-c/newFollowRecord/publicDialog"],{"3f11":function(e,t,n){"use strict";var a,i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.__map(e.list,(function(t,n){var a=t.createTime.split(" ");return{$orig:e.__get_orig(t),g0:a}})));e.$mp.data=Object.assign({},{$root:{l0:n}})},o=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}))},"6ba7":function(e,t,n){"use strict";var a=n("94d1"),i=n.n(a);i.a},"94d1":function(e,t,n){},"9a8d":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("4795"));function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,i,o,r){try{var u=e[o](r),c=u.value}catch(l){return void n(l)}u.done?t(c):Promise.resolve(c).then(a,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function u(e){r(o,a,i,u,c,"next",e)}function c(e){r(o,a,i,u,c,"throw",e)}u(void 0)}))}}var c,l,s=function(){n.e("components/uni-load-more/uni-load-more").then(function(){return resolve(n("fbad"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("components/uni-icons/uni-icons").then(function(){return resolve(n("2cee"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components/fix-box/fix-box").then(function(){return resolve(n("2f8b"))}.bind(null,n)).catch(n.oe)},f={components:{uniIcon:g,uniLoadMore:s,fixbox:d},data:function(){return{loadingType:"more",list:[],content:"",postCode:"",buyOrSell:1,messageType:0,fileUrl:"",pageNum:1,pageSize:5,pictures:[],totalCount:0,isShowDialogue:"false",wigitSell:0,recordCode:""}},filters:{strToArr:function(e){return e.split(",")}},onReachBottom:function(){this.fetchList()},onPullDownRefresh:function(){e("log","here here"," at pages/qing-f-c/newFollowRecord/publicDialog.vue:104"),null!=l&&clearTimeout(l),l=setTimeout((function(){c.fetchMoreList()}),1e3)},onLoad:function(e){c=this,this.buyOrSell=e.buyOrSell,this.recordCode=e.recordCode,this.postCode=a.getStorageSync("pupDefault"),this.fetchList(),this.getShowPrivil(),this.getCount()},methods:{getCount:function(){var t=this;return u(i.default.mark((function n(){var a,o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("/latent/message_count",{data:{recordCode:t.recordCode}});case 2:a=n.sent,e("log",a," at pages/qing-f-c/newFollowRecord/publicDialog.vue:128"),o=a.data.data.list,o.forEach((function(e){2==e.buyOrSell&&(t.wigitSell=e.messageCount)})),e("log",t.wigitSell," at pages/qing-f-c/newFollowRecord/publicDialog.vue:137");case 7:case"end":return n.stop()}}),n)})))()},getShowPrivil:function(){var t=this;return u(i.default.mark((function n(){var a;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("/latent/show",{});case 2:a=n.sent,e("log",a," at pages/qing-f-c/newFollowRecord/publicDialog.vue:141"),t.isShowDialogue=a.data.data.msg,e("log",t.isShowDialogue," at pages/qing-f-c/newFollowRecord/publicDialog.vue:143");case 6:case"end":return n.stop()}}),n)})))()},fetchList:function(){var t=this;return u(i.default.mark((function n(){var o,r,u;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.pageSize=5,o={recordCode:t.recordCode,buyOrSell:t.buyOrSell,pageNum:t.pageNum,pageSize:t.pageSize},n.next=4,t.$http.get("/latent/dialog_list",{data:o});case 4:if(r=n.sent,e("log",r," at pages/qing-f-c/newFollowRecord/publicDialog.vue:158"),!(r.data.data.totalCount>t.totalCount)){n.next=13;break}t.totalCount=r.data.data.totalCount,t.list=r.data.data.list.reverse(),t.list.forEach((function(e){1==e.messageType&&(e.contentList[0].content=e.contentList[0].content.split(","))})),t.list.length>0&&(u="#msg-".concat(t.list[t.list.length-1].messageCode),e("log",u," at pages/qing-f-c/newFollowRecord/publicDialog.vue:170"),t.$nextTick((function(){a.createSelectorQuery().select(u).boundingClientRect((function(t){e("log",t," at pages/qing-f-c/newFollowRecord/publicDialog.vue:173"),a.pageScrollTo({duration:300,scrollTop:t.bottom-150})})).exec()}))),n.next=14;break;case 13:return n.abrupt("return");case 14:case"end":return n.stop()}}),n)})))()},fetchMoreList:function(){var e=this;return u(i.default.mark((function t(){var n,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageSize+=5,c.loadingType="loading",a.showNavigationBarLoading(),n={recordCode:e.recordCode,buyOrSell:e.buyOrSell,pageNum:e.pageNum,pageSize:e.pageSize},t.next=6,e.$http.get("/latent/dialog_list",{data:n});case 6:if(o=t.sent,a.hideNavigationBarLoading(),!(o.data.data.list.length<e.pageSize)){t.next=11;break}return c.loadingType="",t.abrupt("return");case 11:e.list=o.data.data.list.reverse(),e.list.forEach((function(e){1==e.messageType&&(e.contentList[0].content=e.contentList[0].content.split(","))})),c.loadingType="more",a.stopPullDownRefresh();case 15:case"end":return t.stop()}}),t)})))()},sendText:function(){this.messageType=0,this.pictures="",this.sendMessage()},sendMessage:function(){var e=this;return u(i.default.mark((function t(){var n;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={postCode:e.postCode,recordCode:e.recordCode,buyOrSell:e.buyOrSell,messageType:e.messageType,content:e.content,fileUrl:e.pictures},a.showLoading({title:"发言中",mask:!0}),t.next=4,e.$http.post("/latent/dialog_add",{data:n});case 4:t.sent,a.hideLoading(),e.content="",e.pictures="",e.fetchList();case 9:case"end":return t.stop()}}),t)})))()},pickImage:function(){a.chooseImage({sizeType:["compressed"],success:function(t){for(var n=t.tempFilePaths,i=[],o=0;o<n.length;o++)a.uploadFile({url:c.Api.upload,filePath:n[o],name:"file",success:function(t){e("log",t," at pages/qing-f-c/newFollowRecord/publicDialog.vue:259"),i.push(JSON.parse(t.data).data.msg),c.pictures=i.join(","),c.pictures.split(",").length==n.length&&(c.messageType=1,c.sendMessage())}})},complete:function(){}})},selectDeputy:function(e){var t=e.detail.value;"@"==t.substr(t.length-1,1)&&(a.hideKeyboard(),a.navigateTo({url:"./selectContact?buyOrSell=".concat(this.buyOrSell)}))},toSellDialogue:function(){a.navigateTo({url:"./publicDialog?buyOrSell=2&recordCode=".concat(this.recordCode)})},toRecordDetail:function(){a.navigateTo({url:"./detail?recordCode=".concat(this.recordCode)})},toBigPic:function(e){a.previewImage({urls:[e]})},toInquiryDetail:function(e,t){if(t>0){var n=a.getStorageSync("pupDefault");switch(n){case"SELL_DEPUTY":1==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sellDeputy/inquiry-details?inquiryNumber=".concat(e)}):2==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sellDeputy/inquiry-details?inquiryNumber=".concat(e)}):3==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sellDeputy/inquiry-details?inquiryNumber=".concat(e)}):4==t&&a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sellDeputy/inquiry-details?inquiryNumber=".concat(e)});break;case"BUY_DEPUTY":1==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/inquiry-details?inquiryNumber=".concat(e)}):2==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/buyDeputy/inquiry-details?inquiryNumber=".concat(e)}):3==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/quotedPrice/quotedPrice?quoteNumber=".concat(e)}):4==t&&a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/buyDeputy/quotationDetails/quotationDetails?number=".concat(e)});break;case"SALES_DIRECTOR":1==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sales_director/inquiry-details?inquiryNumber=".concat(e)}):2==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sales_director/inquiry-details?inquiryNumber=".concat(e)}):3==t?a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sales_director/quotation-detail?quoteNumber=".concat(e)}):4==t&&a.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sales_director/quotation-details?number=".concat(e)});break;case"REGIONAL_MANAGER":break;case"ANALYST":break}}}}};t.default=f}).call(this,n("0de9")["default"],n("6e42")["default"])},aaaa:function(e,t,n){"use strict";n.r(t);var a=n("9a8d"),i=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},e619:function(e,t,n){"use strict";(function(e){n("3b9b"),n("921b");a(n("66fd"));var t=a(n("fc1a"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},fc1a:function(e,t,n){"use strict";n.r(t);var a=n("3f11"),i=n("aaaa");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("6ba7");var r,u=n("f0c5"),c=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);t["default"]=c.exports}},[["e619","common/runtime","common/vendor"]]]);