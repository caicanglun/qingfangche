(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/qing-f-c/newFollowRecord/publicDialog"],{"6ba7":function(e,t,n){"use strict";var a=n("94d1"),i=n.n(a);i.a},"94d1":function(e,t,n){},"9a8d":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("4795"));function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return s(e)||l(e)||c(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function l(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function s(e){if(Array.isArray(e))return d(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function g(e,t,n,a,i,o,r){try{var u=e[o](r),c=u.value}catch(l){return void n(l)}u.done?t(c):Promise.resolve(c).then(a,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function r(e){g(o,a,i,r,u,"next",e)}function u(e){g(o,a,i,r,u,"throw",e)}r(void 0)}))}}var p,y=function(){n.e("components/uni-load-more/uni-load-more").then(function(){return resolve(n("fbad"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components/uni-icons/uni-icons").then(function(){return resolve(n("2cee"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/fix-box/fix-box").then(function(){return resolve(n("2f8b"))}.bind(null,n)).catch(n.oe)},b={components:{uniIcon:m,uniLoadMore:y,fixbox:h},data:function(){return{loadingType:"more",list:[],content:"",postCode:"",buyOrSell:1,messageType:0,fileUrl:"",pageNum:1,pageSize:5,pictures:[],totalCount:0,isShowDialogue:"false",wigitSell:0,recordCode:"",flag:!0}},filters:{strToArr:function(e){return e.split(",")}},onPageScroll:function(e){e.scrollTop<5&&this.fetchMoreList()},onLoad:function(t){p=this,this.buyOrSell=t.buyOrSell,this.recordCode=t.recordCode,this.postCode=e.getStorageSync("pupDefault"),this.fetchList(),this.getShowPrivil(),this.getCount()},methods:{getCount:function(){var e=this;return f(i.default.mark((function t(){var n,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/latent/message_count",{data:{recordCode:e.recordCode}});case 2:n=t.sent,a("log",n," at pages/qing-f-c/newFollowRecord/publicDialog.vue:136"),o=n.data.data.list,o.forEach((function(t){2==t.buyOrSell&&(e.wigitSell=t.messageCount)})),a("log",e.wigitSell," at pages/qing-f-c/newFollowRecord/publicDialog.vue:145");case 7:case"end":return t.stop()}}),t)})))()},getShowPrivil:function(){var e=this;return f(i.default.mark((function t(){var n;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/latent/show",{});case 2:n=t.sent,a("log",n," at pages/qing-f-c/newFollowRecord/publicDialog.vue:149"),e.isShowDialogue=n.data.data.msg,a("log",e.isShowDialogue," at pages/qing-f-c/newFollowRecord/publicDialog.vue:151");case 6:case"end":return t.stop()}}),t)})))()},fetchList:function(){var e=this;return f(i.default.mark((function t(){var n,o,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageNum=1,n={recordCode:e.recordCode,buyOrSell:e.buyOrSell,pageNum:e.pageNum,pageSize:e.pageSize},t.next=4,e.$http.get("/latent/dialog_list",{data:n});case 4:o=t.sent,a("log",o," at pages/qing-f-c/newFollowRecord/publicDialog.vue:171"),e.totalCount=o.data.data.totalCount,r="",r="#msg-".concat(o.data.data.list[0].messageCode),a("log",r," at pages/qing-f-c/newFollowRecord/publicDialog.vue:187"),e.list=o.data.data.list.reverse(),e.list.forEach((function(e){1==e.messageType&&(e.contentList[0].content=e.contentList[0].content.split(","))})),e.$nextTick((function(){e.setPageScrollTo(r)}));case 13:case"end":return t.stop()}}),t)})))()},fetchMoreList:function(){var t=this;return f(i.default.mark((function n(){var o,u,c,l;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(""!=p.loadingType){n.next=2;break}return n.abrupt("return");case 2:return t.pageNum+=1,p.loadingType="",e.showNavigationBarLoading(),o={recordCode:t.recordCode,buyOrSell:t.buyOrSell,pageNum:t.pageNum,pageSize:t.pageSize},n.next=8,t.$http.get("/latent/dialog_list",{data:o});case 8:u=n.sent,e.hideNavigationBarLoading(),u.data.data.isLastPage?p.loadingType="":setTimeout((function(){p.loadingType="more"}),1e3),c="#msg-".concat(u.data.data.list[0].messageCode),a("log",c," at pages/qing-f-c/newFollowRecord/publicDialog.vue:245"),l=u.data.data.list.reverse(),l.forEach((function(e){1==e.messageType&&(e.contentList[0].content=e.contentList[0].content.split(","))})),t.list=[].concat(r(l),r(t.list)),t.$nextTick((function(){t.setPageScrollTo(c)}));case 17:case"end":return n.stop()}}),n)})))()},sendText:function(){this.messageType=0,this.pictures="",this.sendMessage()},sendMessage:function(){var t=this;return f(i.default.mark((function n(){var a;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={postCode:t.postCode,recordCode:t.recordCode,buyOrSell:t.buyOrSell,messageType:t.messageType,content:t.content,fileUrl:t.pictures},e.showLoading({title:"发言中",mask:!0}),n.next=4,t.$http.post("/latent/dialog_add",{data:a});case 4:n.sent,e.hideLoading(),t.content="",t.pictures="",t.fetchList();case 9:case"end":return n.stop()}}),n)})))()},pickImage:function(){e.chooseImage({sizeType:["compressed"],success:function(t){for(var n=t.tempFilePaths,i=[],o=0;o<n.length;o++)e.uploadFile({url:p.Api.upload,filePath:n[o],name:"file",success:function(e){a("log",e," at pages/qing-f-c/newFollowRecord/publicDialog.vue:303"),i.push(JSON.parse(e.data).data.msg),p.pictures=i.join(","),p.pictures.split(",").length==n.length&&(p.messageType=1,p.sendMessage())}})},complete:function(){}})},selectDeputy:function(t){var n=t.detail.value;"@"==n.substr(n.length-1,1)&&(e.hideKeyboard(),e.navigateTo({url:"./selectContact?buyOrSell=".concat(this.buyOrSell)}))},toSellDialogue:function(){e.navigateTo({url:"./publicDialog?buyOrSell=2&recordCode=".concat(this.recordCode)})},toRecordDetail:function(){e.navigateTo({url:"./detail?recordCode=".concat(this.recordCode)})},setPageScrollTo:function(t){var n=e.createSelectorQuery().in(this).select(t);n.boundingClientRect((function(t){e.pageScrollTo({scrollTop:t.top-30,duration:0})})).exec()},toBigPic:function(t){e.previewImage({urls:[t]})},toInquiryDetail:function(t,n){if(n>0){var a=e.getStorageSync("pupDefault");switch(a){case"SELL_DEPUTY":1==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sellDeputy/inquiry-details?inquiryNumber=".concat(t)}):2==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sellDeputy/inquiry-details?inquiryNumber=".concat(t)}):3==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sellDeputy/inquiry-details?inquiryNumber=".concat(t)}):4==n&&e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sellDeputy/inquiry-details?inquiryNumber=".concat(t)});break;case"BUY_DEPUTY":1==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/inquiry-details?inquiryNumber=".concat(t)}):2==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/buyDeputy/inquiry-details?inquiryNumber=".concat(t)}):3==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/quotedPrice/quotedPrice?quoteNumber=".concat(t)}):4==n&&e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/buyDeputy/quotationDetails/quotationDetails?number=".concat(t)});break;case"SALES_DIRECTOR":1==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sales_director/inquiry-details?inquiryNumber=".concat(t)}):2==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sales_director/inquiry-details?inquiryNumber=".concat(t)}):3==n?e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sales_director/quotation-detail?quoteNumber=".concat(t)}):4==n&&e.navigateTo({url:"/pages/qing-f-c/inquiryManage/sampleInquiry/sales_director/quotation-details?number=".concat(t)});break;case"REGIONAL_MANAGER":break;case"ANALYST":break}}}}};t.default=b}).call(this,n("6e42")["default"],n("0de9")["default"])},aaaa:function(e,t,n){"use strict";n.r(t);var a=n("9a8d"),i=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},bed0:function(e,t,n){"use strict";var a,i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.__map(e.list,(function(t,n){var a=t.createTime.split(" ");return{$orig:e.__get_orig(t),g0:a}})));e.$mp.data=Object.assign({},{$root:{l0:n}})},o=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}))},e619:function(e,t,n){"use strict";(function(e){n("3b9b"),n("921b");a(n("66fd"));var t=a(n("fc1a"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},fc1a:function(e,t,n){"use strict";n.r(t);var a=n("bed0"),i=n("aaaa");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("6ba7");var r,u=n("f0c5"),c=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);t["default"]=c.exports}},[["e619","common/runtime","common/vendor"]]]);