(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/qing-f-c/printer/printContent"],{"166e":function(e,t,n){"use strict";n.r(t);var i=n("f931"),r=n("23d0");for(var c in r)"default"!==c&&function(e){n.d(t,e,function(){return r[e]})}(c);var s,a=n("f0c5"),o=Object(a["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);t["default"]=o.exports},"23d0":function(e,t,n){"use strict";n.r(t);var i=n("4c5f"),r=n.n(i);for(var c in i)"default"!==c&&function(e){n.d(t,e,function(){return i[e]})}(c);t["default"]=r.a},"4c5f":function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,c=n("f30c"),s=n("48a9"),a={data:function(){return{devices:[],currDev:null,connId:"",piaojuText:"",number:"",orderType:"",topList:"",url:"",showData:"",isAnalysis:""}},computed:{},onLoad:function(e){r=this,this.number=e.number,this.orderType=e.orderType,this.isAnalysis=e.isAnalysis,this.getInquiryInfo()},onUnload:function(){r.destroyed()},methods:{getInquiryInfo:function(){var t=this.Api.qrCode,n={number:r.number,orderType:r.orderType,isAnalysis:r.isAnalysis};this.myRequest(n,t,"get").then(function(t){e("log",t," at pages/qing-f-c/printer/printContent.vue:76"),r.topList=t.data.data,r.number=t.data.data.number,r.orderType=t.data.data.orderType,e("log","number",r.number," at pages/qing-f-c/printer/printContent.vue:81"),e("log","orderType",r.orderType," at pages/qing-f-c/printer/printContent.vue:82"),r.showData=t.data.data.showData}).catch(function(e){wx.showToast({title:e.data.errMsg,icon:"none"})})},destroyed:function(){e("log","destroyed----------"," at pages/qing-f-c/printer/printContent.vue:95"),""!=this.connId&&i.closeBLEConnection({deviceId:this.connId,success:function(t){e("log",t," at pages/qing-f-c/printer/printContent.vue:100")}})},searchBle:function(){var t=this;e("log","initBule"," at pages/qing-f-c/printer/printContent.vue:108"),i.openBluetoothAdapter({success:function(n){e("log","打开 蓝牙模块"," at pages/qing-f-c/printer/printContent.vue:111"),e("log",n," at pages/qing-f-c/printer/printContent.vue:112"),t.onDevice(),i.getBluetoothAdapterState({success:function(n){e("log",n," at pages/qing-f-c/printer/printContent.vue:116"),n.available?(n.discovering&&t.stopFindBule(),e("log","开始搜寻附近的蓝牙外围设备"," at pages/qing-f-c/printer/printContent.vue:123"),i.startBluetoothDevicesDiscovery({success:function(t){e("log",t," at pages/qing-f-c/printer/printContent.vue:126")}})):(e("log","本机蓝牙不可用"," at pages/qing-f-c/printer/printContent.vue:131"),i.showToast({title:"本机蓝牙不可用",icon:"none",duration:2e3}))}})}})},onDevice:function(){e("log","监听寻找到新设备的事件---------------"," at pages/qing-f-c/printer/printContent.vue:144");var t=this;t.devices=[],i.onBluetoothDeviceFound(function(n){e("log","--------------new-----------------------"+JSON.stringify(n)," at pages/qing-f-c/printer/printContent.vue:149");var i=JSON.parse(JSON.stringify(n));e("log",i.devices[0].name+"  "+i.devices[0].deviceId," at pages/qing-f-c/printer/printContent.vue:151");var r=i.devices[0].name;if("未知设备"!=r){var c=i.devices[0].deviceId;t.devices.push({name:r,deviceId:c,services:[]})}})},stopFindBule:function(){e("log","停止搜寻附近的蓝牙外围设备---------------"," at pages/qing-f-c/printer/printContent.vue:169"),i.stopBluetoothDevicesDiscovery({success:function(t){e("log",t," at pages/qing-f-c/printer/printContent.vue:172")}})},onConn:function(t){var n=this;e("log","连接蓝牙---------------"+t.deviceId," at pages/qing-f-c/printer/printContent.vue:178");var r=t.deviceId;i.createBLEConnection({deviceId:r,complete:function(c){"createBLEConnection:ok"==c.errMsg?(e("log","连接蓝牙-["+t.name+"]--成功"," at pages/qing-f-c/printer/printContent.vue:184"),i.showToast({title:"连接成功",duration:3e3}),n.connId=r,n.currDev=t,setTimeout(function(){n.getBLEServices(r)},2e3)):e("log",c," at pages/qing-f-c/printer/printContent.vue:195"),n.stopFindBule()}})},getBLEServices:function(t){var n=this,r=t;e("log","获取蓝牙设备所有服务(service)。---------------"," at pages/qing-f-c/printer/printContent.vue:207"),i.getBLEDeviceServices({deviceId:r,complete:function(t){e("log",t," at pages/qing-f-c/printer/printContent.vue:213");for(var c=function(){e("log",t.services[s].uuid," at pages/qing-f-c/printer/printContent.vue:216");var c=t.services[s].uuid;i.getBLEDeviceCharacteristics({deviceId:r,serviceId:c,success:function(t){var i=JSON.parse(JSON.stringify(t));e("log","deviceId = ["+r+"]  serviceId = ["+c+"]"," at pages/qing-f-c/printer/printContent.vue:226");for(var s=0;s<i.characteristics.length;s++)if(1==i.characteristics[s].properties.write){var a=i.characteristics[s].uuid;for(var o in e("log"," deviceId = ["+r+"]  serviceId = ["+c+"] characteristics=["+a," at pages/qing-f-c/printer/printContent.vue:230"),n.devices)if(n.devices[o].deviceId==r){n.devices[o].services.push({serviceId:c,characteristicId:a});break}e("log",JSON.stringify(n.devices)," at pages/qing-f-c/printer/printContent.vue:243")}}})},s=0;s<t.services.length;s++)c()},fail:function(t){e("log",t," at pages/qing-f-c/printer/printContent.vue:256")}})},senBlData:function(t,n,r,c){e("log","************deviceId = ["+t+"]  serviceId = ["+n+"] characteristics=["+r+"]"," at pages/qing-f-c/printer/printContent.vue:262");var s=Array.from(c);function a(t,n){for(var i={},r=0,c=0;c<t.length;c+=n)i[r]=t.slice(c,c+n),r++;return e("log",i," at pages/qing-f-c/printer/printContent.vue:271"),i}var o=a(s,20);function u(c,s){var a=c[s];if("undefined"!=typeof a){e("log","第【"+s+"】次写数据"+a," at pages/qing-f-c/printer/printContent.vue:281");for(var o=new ArrayBuffer(a.length),p=new DataView(o),v=0;v<a.length;v++)p.setUint8(v,a[v]);i.writeBLECharacteristicValue({deviceId:t,serviceId:n,characteristicId:r,value:o,success:function(e){u(c,s+1)}})}}var p=0;u(o,p)},senBleLabel:function(){var e=r.topList.orderType+"#轻纺车网络科技欢迎你#"+r.topList.number;i.showToast({title:e,duration:1e3});var t=30,n=this.currDev.deviceId,s=this.currDev.services[0].serviceId,a=this.currDev.services[0].characteristicId,o=c.jpPrinter.createNew();o.setSize(74,52),o.setGap(2),o.setCls();for(var u=0;u<r.showData.length;u++)o.setText(250,t,"TSS24.BF2",1,1,r.showData[u]),t+=35;o.setText(20,30,"TSS24.BF2",2,2,"轻纺车网"),o.setText(60,100,"TSS24.BF2",1,1,"144F.com"),o.setQR(20,140,"L",8,"A",e),o.setPagePrint(),this.senBlData(n,s,a,o.getData())},senBleLabel2:function(){var e=this.currDev.deviceId,t=this.currDev.services[0].serviceId,n=this.currDev.services[0].characteristicId,i=s.jpPrinter.createNew();i.init(),i.setText(this.piaojuText),i.setPrintAndFeedRow(1),this.senBlData(e,t,n,i.getData())}}};t.default=a}).call(this,n("0de9")["default"],n("6e42")["default"])},f108:function(e,t,n){"use strict";(function(e){n("3b9b"),n("921b");i(n("66fd"));var t=i(n("166e"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},f931:function(e,t,n){"use strict";var i,r=function(){var e=this,t=e.$createElement;e._self._c},c=[];n.d(t,"b",function(){return r}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return i})}},[["f108","common/runtime","common/vendor"]]]);